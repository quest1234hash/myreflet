<%- include('header'); -%>

<div>
   <div class="main-bredcrum-box">
        <nav aria-label="breadcrumb">
        <ul class="breadcrumb">
          <li class="breadcrumb-item active" aria-current="page">
            Verifier List
          </li>
          <li class="breadcrumb-item active" aria-current="page">
            <a href="">Manage My Reflet ID</a>
          </li>
        </ul>
      </nav>
    </div>
	<div class="page-header">
      <h3 class="page-title">
        <span class="page-title-icon bg-gradient-primary text-white mr-2">
          <i class="mdi mdi-file-check"></i>
        </span> Manage My Reflet ID </h3>
    </div>
    <div class="row">
      <div class="col-md-11 m-auto">
           <div class="main-heading-verfy-row">
              <div class="row align-middle-flex">
                    <div class="col-md-3">
                       <h5 class="mb-0 clearfix">
                        Type   
                      </h5>
                    </div>
                    <div class="col-md-2">
                       <h5 class="mb-0 clearfix">
                        My Reflet ID
                      </h5>
                    </div>
                    <div class="col-md-2">
                       <h5 class="mb-0 clearfix">
                        Name   
                      </h5>
                    </div>
                    <div class="col-md-4">
                       <h5 class="mb-0 clearfix">
                        Email ID 
                      </h5>
                    </div>
                    
                    <div class="col-md-1 text-right">
                       <h5 class="mb-0 clearfix">
                        Action  
                      </h5>
                    </div>
                  </div>
           </div>
           <% if(verifier_result.length>0)
           { 
              var i=0;
              var j=1;
              verifier_result.forEach(function(each_data){
                 %>
          <div class="accordion bg-transperent" id="accordionExample">
              <div class="card">
                <div class="card-header first-id-row" id="headingOne">
                  <div class="row align-middle-flex">
                    <div class="col-md-3">
                        <% if(each_data.reflectid_by=='representative'){ %>
                       <h5 class="mb-0 clearfix">

                         <img class="type-img" src="/admin-assets/images/icons/repersentative.png">                             Representative   

                      </h5>
                      <%}else{%>

                      <h5 class="mb-0 clearfix">
                          <img class="type-img" src="/admin-assets/images/icons/entity.png">
                          Entity   
                       </h5>
                       <%}%>

                    </div>
                    <div class="col-md-2">
                       <h5 class="mb-0 clearfix">
                          <%=each_data.reflect_code%> 
                      </h5>
                    </div>
                    <div class="col-md-2">
                       <h5 class="mb-0 clearfix">
                          <%=each_data.rep_firstname%> 
 
                      </h5>
                    </div>
                    <div class="col-md-4">
                       <h5 class="mb-0 clearfix">
                          <%=each_data.rep_emailid%> 
                      </h5>
                    </div>
                    
                    <div class="col-md-1 text-right">
                       <button class="bg-gradient-primary text-white" data-toggle="collapse" data-target="#verifierone<%=i%>" aria-expanded="false" aria-controls="verifierone">
                         <i class="mdi mdi-menu-down"></i>
                       </button>
                    </div>
                  </div>
                </div>
                <%
              i++;	j++;		
          });
             }
   %>
                <% if(verifier_list.data.length>0)
                { 
                   var i=0;
                   var j=1;
                   verifier_list.data.forEach(function(each_data){
                     
                      %>
              <div class="data_verifier">
                <div id="verifierone<%=i%>" class="collapse main-outer-verifier" aria-labelledby="headingOne" data-parent="#accordionExample">
                  <div class="">
                    <div class="card">
                      <div class="card-body">
                        <div>
                           
                           <div class="row">
                             <div class="col-md-12 m-auto">
                                 <div class="row">
                                   <div class="col-md-2">
                                     <div class="account-detail-block">
                                          <h6>First Name</h6>
                                          <h5><%=each_data.rep_firstname%> 
                                          </h5>
                                        </div>
                                   </div>
                                    <div class="col-md-3">
                                     <div class="account-detail-block">
                                          <h6>Last Name</h6>
                                          <h5><%=each_data.rep_lastname%> </h5>
                                    </div>
                                   </div>
                                     <div class="col-md-4">
                                       <div class="account-detail-block">
                                            <h6>Email ID</h6>
                                            <h5><%=each_data.rep_emailid%></h5>
                                          </div>
                                     </div>
                                      <div class="col-md-3">
                                       <div class="account-detail-block">
                                          <h6>My Reflet ID Code</h6>
                                          <h5><%=each_data.reflect_code%> </h5>
                                        </div>
                                     </div>
                                 </div>
                                   <div class="row">
                                   <div class="col-md-2">
                                    <div class="account-detail-block">
                                            <h6>Country</h6>
                                            <h5>UK</h5>
                                          </div>
                                     
                                   </div>
                                    <div class="col-md-3">
                                     <div class="account-detail-block">
                                          <h6>Mobile Number</h6>
                                          <h5><%=each_data.mobile_number%></h5>
                                        </div>
                                   </div>
                                     <div class="col-md-4">
                                       <div class="account-detail-block">
                                            <h6>Submitted On</h6>
                                            <h5><%=moment(each_data.created_at).format('MMM DD, YYYY')%></h5>
                                          </div>
                                     </div>
                                      <div class="col-md-3">
                                       <div class="account-detail-block">
                                            <h6>Verified Status</h6>
                                            <div class="verifier-typ-img for-verify-typ">
                                                <% if(each_data.email_verification_status=='yes'){ %>

                                               <img src="/admin-assets/images/icons/email.png"><span>Email &nbsp;</span>
                                               <%}else{%>

                                                   <%}%>
                                                   <img src="/admin-assets/images/icons/phone.png"><span>Phone</span>

                                               <!-- <% if(each_data.email_verification_status=='yes'){ %> -->

                                                <!-- <img src="/admin-assets/images/icons/email.png"><span>Email &nbsp;</span> -->
                                                <!-- <%}else{%> -->
 
                                                <!-- <%}%> -->
                                             </div>
                                          </div>
                                     </div>
                                 </div>
                             </div>
                           </div>
                        </div>
                      </div>
                    </div>

                    <h4 class="Main-heading mt-40 mb-0">Received Documents</h4>
                    <div class="recived-doc-details">
                      <div id="accordion">
                        <div class="card">
                          <div class="card-header" id="headingOne">
                            <div class="row align-middle-flex">
                              <div class="col-md-8">
                                 <h5 class="mb-0 clearfix upper">
                                    <%=each_data.document_name%>          
                                                        </h5>
                              </div>
                              <div class="col-md-4 text-right">
                                 <button class="bg-gradient-primary text-white" data-toggle="collapse" data-target="#collapseOne<%=i%>"  aria-expanded="true" aria-controls="collapseOne">
                                   <i class="mdi mdi-menu-down"></i>
                                 </button>
                              </div>
                            </div>
                          </div>

                          <div id="collapseOne<%%>" class="collapse show" aria-labelledby="headingOne" data-parent="#accordion">
                            <div class="card-body table-responsive">
                                <table class="table document-table">
                                  <thead>
                                    <tr>
                                      <th width="20%">Version</th>
                                      <th width="10%">Document</th>
                                      <th width="15%">Date</th>
                                      <th width="10%">ID Code</th>
                                      <th width="10%">Status</th>
                                      <th width="25%">Reason</th>
                                      <th width="10%">Action</th>
                                    </tr>
                                  </thead>
                                  <tbody>
                                    <tr>
                                      <td class="upper"><%=each_data.document_name%></h5></td>
                                      <td>
                                        <div class="verifier-typ-img ">
                                          <img src="/documents/<%=each_data.document_filename%>">

                                        </div>
                                      </td>
                                      <td><%=moment(each_data.created_at).format('MMM DD, YYYY')%></td>
                                      <td><%=each_data.doc_unique_code%></td>
                                      <td>
                                        <p class="pending"><%=each_data.certified_status%></p>
                                      </td>
                                      <td>
                                        <p>
                                          The Picture was not clear.
                                        </p>
                                      </td>
                                      <td class="reject-accept">
                                        <i class="approve mdi mdi-checkbox-marked-circle"></i>
                                        <a href="" data-toggle="modal" data-target="#myModal-reason"><i class="reject mdi mdi-close-circle"></i></a>
                                        
                                        
                                      </td>
                                    </tr>
                                   
                                  </tbody>
                                </table>
                            </div>
                          </div>
                        </div>
                      
                      </div>
                    </div>
                  </div>
                </div>
            
              </div>
              </div>
              <%
              i++;	j++;		
          });
             }
   %>
           
              
      </div>
    </div>
</div>


<!-- Modal -->
<div id="myModal-reason" class="modal fade modal-reason" role="dialog">
  <div class="modal-dialog">
    <!-- Modal content-->
    <div class="modal-content">
      <div class="modal-header">
        <button type="button" class="close" data-dismiss="modal">&times;</button>
      </div>
      <div class="modal-body">
           <div class="reason-heading">
               <div class="reason-box">
                 <div class="inner-border">
                   <i class="fas fa-question"></i>
                 </div>
               </div>
               <div>
                 Reason For Rejecting Document
               </div>
           </div>
           <div class="reason-form">
             <div class="form-group">
               <label for=""> Reason </label>
                <input type="text" class="form-control" placeholder="Enter the reason">
              </div>
              <div class="popup-btn">
                <a href="" class="btn btn-common bg-gradient-primary">Submit</a>
                <a href="" class="btn btn-common bg-gradient-primary">Cancel</a>
              </div>
           </div>
      </div>
    </div>

  </div>
</div>

<%- include('footer'); -%>
<link rel="stylesheet" type="text/css" href="https://cdn.datatables.net/1.10.20/css/jquery.dataTables.css">
<script type="text/javascript" charset="utf8" src="https://cdn.datatables.net/1.10.20/js/jquery.dataTables.js"></script>
<link rel="stylesheet" type="text/css" href="https://cdn.datatables.net/1.10.20/css/jquery.dataTables.css">
<script type="text/javascript" charset="utf8" src="https://cdn.datatables.net/1.10.20/js/jquery.dataTables.js"></script>
<script src="https://cdn.rawgit.com/rainabba/jquery-table2excel/1.1.0/dist/jquery.table2excel.min.js"></script>
<script src="https://ajax.googleapis.com/ajax/libs/jquery/3.4.1/jquery.min.js"></script>
<script type="text/javascript" charset="utf8" src="https://cdn.datatables.net/1.10.20/js/jquery.dataTables.js"></script>
<script src="https://cdn.rawgit.com/rainabba/jquery-table2excel/1.1.0/dist/jquery.table2excel.min.js"></script>

<script src="https://cdnjs.cloudflare.com/ajax/libs/jquery-validate/1.19.1/jquery.validate.min.js"></script>
<script src="https://cdn.rawgit.com/rainabba/jquery-table2excel/1.1.0/dist/jquery.table2excel.min.js"></script>

<script>

 
    function export_table(){
        // alert('hhh')
      // $('.hide_link').show();
    
        $("#myTable3").table2excel({
          filename: "Verifier-list.xls",
          exclude:'.hide_link',
        });
      //   $('.hide_link').show();
      window.location.reload(true);
    
      };
      
      function print_table(){
        $('.hide_link').hide();
     
       // $("#user_div").print();
       var divToPrint=document.getElementById("myTable3");
       newWin= window.open("");
       newWin.document.write(divToPrint.outerHTML);
       window.location.reload(true);
    
       newWin.print();
       newWin.close();
    
        }   
   </script>
<script>
    $(document).ready(function(){
      (".data_verfier").hide();
      $("#myInput").on("keyup", function() {
        var value = $(this).val().toLowerCase();
        $("#myTable tr").filter(function() {

          $(this).toggle($(this).text().toLowerCase().indexOf(value) > -1)
        });
      });
    });
 </script> 

 <script>
  $('.select_option').click(function() {
    $('.status_table').html(" ")

    var option = $('option:selected', this).attr('mytag');
    //  alert(option)
     if(option==0)
     {
      location.reload(true);     
      }
     
    //  var checkstr =  confirm('Are You Sure You Want To Active?');
    $.ajax({
                      type : 'POST',
                      url  : '/show-verifier-by-status',
					            data: {option_value:option},
					  
                       success: function(verifier_data) {


                     if(verifier_data.length==0)
                      {

                             $(".data_table").hide();

                                    $(".status_table").append(`<td><td><td>No record found</td></td></td>`);

                      }
                    else{
                      

                    console.log("ajax success data : ")	
                    $('.data_table').hide();
                  $(".status_table").show();
                  verifier_data.forEach(function(each_data){
                    
                      
                    $(".status_table").append(`  <tr>
                 
                 <td>
                   <div>
                     <p class="">UI-${each_data.user_id}</p>
                   </div>
                 </td>
                 <td>
                   <div> 
                     <p class="upper">${each_data.full_name}</p>
                   </div>
                  </td>
                  <td>
                          <div> 
                            <p class="upper">${each_data.email}</p>
                          </div>
                  </td>
                  <!-- <td>
                          <div> 
                            <p class="upper">${each_data.mobile_number}</p>
                          </div>
                  </td> -->
                  <td>
                          <div> 
                            <p class="upper">${each_data.dob}</p>
                          </div>
                           

                  </td>
                  <td>
                      <div> 
                        <p class="upper">${each_data.birthplace}</p>
                      </div>
                     

              </td>
              <td>
                 
                  <div> 
                    <p class="upper">${each_data.status}</p>
                  </div>
                 

           </td>
              <td>
                 
                  <div> 
                    <p class="upper">${each_data.numReflect}</p>
                  </div>
                 

           </td>
                   <td>
                     <div class="dropdown-menu-new">
                        <a class="nav-link dropdown-toggle" id="profileDropdown" href="#" data-toggle="dropdown" aria-expanded="false">
                          <i class="fas fa-ellipsis-v"></i>
                        </a>
                        <div class="dropdown-menu navbar-dropdown" aria-labelledby="profileDropdown">
                          <a class="dropdown-item" href="manage_request.php"><i class="fas fa-cogs"></i> Manage MyReflet ID</a>
                          <!-- <a class="dropdown-item" href="#"><i class="mdi mdi-close-box"></i> Reject</a> -->
                          <a class="dropdown-item" href="/delete/:${each_data.user_id}"><i class="mdi mdi-delete"></i> Delete</a>
                          <a class="dropdown-item" href="/block-verifier/:${each_data.user_id}"><i class="mdi mdi-delete-forever"></i> Block</a>
                        </div>
                     </div>
                   </td>
                </tr>`);

                    });


          } 
              }                                                    
           
})
})
 
  
 
           
 </script>